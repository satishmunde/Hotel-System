<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order Status</title>
    <!-- Include jqGrid CSS from CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jquery-ui-dist/jquery-ui.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jqgrid/css/ui.jqgrid.min.css"
    />
    <!-- Include jQuery from CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include jQuery UI from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/jquery-ui-dist/jquery-ui.min.js"></script>
    <!-- Include jqGrid JS from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/jqgrid/js/jquery.jqgrid.min.js"></script>
    <!-- Include jsPDF from CDN for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.6.0/jspdf.umd.min.js"></script>
    <!-- Include PapaParse from CDN for CSV export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  </head>
  <body>
    <div class="container">
      <h4 class="card-title">Order Status</h4>
      <button id="exportCSV" class="btn btn-primary">Export to CSV</button>
      <button id="printPDF" class="btn btn-primary">Print to PDF</button>
      <table id="jqGrid"></table>
      <div id="jqGridPager"></div>
    </div>

    <script>
      $(document).ready(function () {
        // Initialize jqGrid
        $("#jqGrid").jqGrid({
          datatype: "local",
          colModel: [
            { name: "id", label: "ID", key: true, width: 50, sorttype: "int" },
            {
              name: "ClientName",
              label: "Client Name",
              width: 150,
              formatter: "actions",
              formatoptions: { keys: true },
            },
            { name: "OrderNo", label: "Order No", width: 100 },
            { name: "ProductCost", label: "Product Cost", width: 100 },
            { name: "Project", label: "Project", width: 150 },
            { name: "PaymentMode", label: "Payment Mode", width: 150 },
            { name: "StartDate", label: "Start Date", width: 120 },
            {
              name: "PaymentStatus",
              label: "Payment Status",
              width: 120,
              formatter: function (cellValue) {
                switch (cellValue) {
                  case "Approved":
                    return "<span class='badge badge-success'>Approved</span>";
                  case "Pending":
                    return "<span class='badge badge-warning'>Pending</span>";
                  case "Rejected":
                    return "<span class='badge badge-danger'>Rejected</span>";
                }
              },
            },
          ],
          data: [
            {
              id: 1,
              ClientName: "Henry Klein",
              OrderNo: "02312",
              ProductCost: "$14,500",
              Project: "Dashboard",
              PaymentMode: "Credit card",
              StartDate: "04 Dec 2019",
              PaymentStatus: "Approved",
            },
            {
              id: 2,
              ClientName: "Estella Bryan",
              OrderNo: "02312",
              ProductCost: "$14,500",
              Project: "Website",
              PaymentMode: "Cash on delivered",
              StartDate: "04 Dec 2019",
              PaymentStatus: "Pending",
            },
            {
              id: 3,
              ClientName: "Lucy Abbott",
              OrderNo: "02312",
              ProductCost: "$14,500",
              Project: "App design",
              PaymentMode: "Credit card",
              StartDate: "04 Dec 2019",
              PaymentStatus: "Rejected",
            },
            {
              id: 4,
              ClientName: "Peter Gill",
              OrderNo: "02312",
              ProductCost: "$14,500",
              Project: "Development",
              PaymentMode: "Online Payment",
              StartDate: "04 Dec 2019",
              PaymentStatus: "Approved",
            },
            {
              id: 5,
              ClientName: "Sallie Reyes",
              OrderNo: "02312",
              ProductCost: "$14,500",
              Project: "Website",
              PaymentMode: "Credit card",
              StartDate: "04 Dec 2019",
              PaymentStatus: "Approved",
            },
          ],
          pager: "#jqGridPager",
          rowNum: 10,
          viewrecords: true,
          height: "auto",
          caption: "Order Status",
        });

        // Export to CSV
        $("#exportCSV").click(function () {
          const data = $("#jqGrid").jqGrid("getGridParam", "data");
          const csv = Papa.unparse(data);
          const csvBlob = new Blob([csv], { type: "text/csv" });
          const url = URL.createObjectURL(csvBlob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "data.csv";
          a.click();
        });

        // Print to PDF
        $("#printPDF").click(function () {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          const rows = [];
          const data = $("#jqGrid").jqGrid("getGridParam", "data");
          data.forEach((row) => {
            rows.push([
              row.ClientName,
              row.OrderNo,
              row.ProductCost,
              row.Project,
              row.PaymentMode,
              row.StartDate,
              row.PaymentStatus,
            ]);
          });

          doc.autoTable({
            head: [
              [
                "Client Name",
                "Order No",
                "Product Cost",
                "Project",
                "Payment Mode",
                "Start Date",
                "Payment Status",
              ],
            ],
            body: rows,
          });

          doc.save("data.pdf");
        });
      });
    </script>
  </body>
</html>
